<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <link rel="shortcut icon" href="des/logoweb.png" type="image/png">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SampProyect | Rol en español</title>
    <style>
        /* --- Variables de Color y Fuentes --- */
        :root {
            --color-bg: #121416;
            --color-contrast: #191B1F;
            --color-contrast-light: #353B47;
            --color-blue: #1D91F7;
            --color-green: #55FB83;
            --color-yellow: #FCCF3A;
            --color-text: #E0E7EF;
            --color-text-muted: #9DA5B0;
            --font-primary: 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            --transition-speed: 0.3s;
            --animation-duration: 0.5s; 
        }

        /* --- Reset Básico y Estilos Globales --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: var(--font-primary);
            background-color: var(--color-bg);
            color: var(--color-text);
            line-height: 1.7;
            font-size: 16px;
            overflow-x: hidden;
            opacity: 0;
            animation: fadeInPage 0.8s ease-out forwards;
        }
        @keyframes fadeInPage { to { opacity: 1; } }
        a { color: var(--color-blue); text-decoration: none; transition: color var(--transition-speed) ease; }
        a:hover { color: var(--color-green); }
        img { max-width: 100%; height: auto; display: block; }
        .container { width: 90%; max-width: 1200px; margin: 0 auto; padding: 0 15px; }
        h1, h2, h3, h4, h5, h6 { font-weight: 600; line-height: 1.3; color: var(--color-text); }
        h1 { font-size: 2.8em; margin-bottom: 0.5em; }
        h2 { font-size: 2.2em; margin-bottom: 1em; text-align: center; color: var(--color-blue); }
        h2::after { content: ''; display: block; width: 80px; height: 4px; background-color: var(--color-green); margin: 15px auto 0; border-radius: 2px; }
        h3 { font-size: 1.5em; margin-bottom: 0.7em; color: var(--color-green); }
        button, .button-style {
            background: var(--color-blue); color: var(--color-bg); border: none; padding: 10px 20px; 
            font-weight: bold; cursor: pointer; border-radius: 5px;
            transition: all var(--transition-speed) ease;
            display: inline-block; text-align: center;
        }
        button:hover, .button-style:hover { background: var(--color-green); transform: translateY(-2px); }


        /* --- Barra de Navegación --- */
        header { background-color: var(--color-contrast); padding: 15px 0; border-bottom: 3px solid var(--color-blue); position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.3); }
        nav { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; }
        nav .logo { font-size: 1.9em; font-weight: 700; color: var(--color-text); text-transform: uppercase; letter-spacing: 1px; }
        nav .logo span { color: var(--color-blue); }
        nav ul { list-style: none; display: flex; align-items: center; flex-wrap: wrap; }
        nav ul li { margin-left: 20px; position: relative; /* Para el menú desplegable */ }
        nav ul li a, nav ul li button.nav-button { color: var(--color-text-muted); font-weight: 500; padding: 10px 15px; border-radius: 5px; transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease, transform 0.2s ease; display: inline-block; font-size: 0.95em; background: none; border: none; cursor: pointer; }
        nav ul li a:hover, nav ul li button.nav-button:hover, nav ul li a.active-link { background-color: var(--color-contrast-light); color: var(--color-text); transform: translateY(-2px); }
        
        /* Estilos para el botón de menú de usuario */
        #user-menu-button {
            display: flex; align-items: center; gap: 8px;
            padding: 8px 12px; border-radius: 5px; cursor: pointer;
            transition: background-color var(--transition-speed);
        }
        #user-menu-button:hover { background-color: var(--color-contrast-light); }
        #user-icon-display { font-size: 1.2em; color: var(--color-text); }
        #user-info { color: var(--color-green); font-weight: bold; }
        #dropdown-arrow { font-size: 0.7em; color: var(--color-text-muted); margin-left: 5px; transition: transform 0.2s; }
        #user-menu-button.open #dropdown-arrow { transform: rotate(180deg); }

        /* Menú Desplegable de Usuario */
        .user-dropdown-menu {
            display: none; /* Oculto por defecto */
            position: absolute;
            top: 100%; /* Debajo del botón */
            right: 0;
            background-color: var(--color-contrast);
            border: 1px solid var(--color-contrast-light);
            border-radius: 5px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            z-index: 1001;
            min-width: 200px;
            padding: 5px 0;
            animation: fadeInDropdown 0.2s ease-out;
        }
        @keyframes fadeInDropdown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .user-dropdown-menu.active { display: block; }
        .user-dropdown-menu ul { list-style: none; padding: 0; margin: 0; width: 100%; flex-direction: column; }
        .user-dropdown-menu ul li a, .user-dropdown-menu ul li button {
            display: block; width: 100%; text-align: left;
            padding: 10px 15px;
            color: var(--color-text-muted);
            font-weight: 500; font-size: 0.9em;
            background: none; border: none; cursor: pointer;
            transition: background-color var(--transition-speed), color var(--transition-speed);
        }
        .user-dropdown-menu ul li a:hover, .user-dropdown-menu ul li button:hover {
            background-color: var(--color-contrast-light);
            color: var(--color-text);
        }
        .user-dropdown-menu ul li hr {
            border: none; border-top: 1px solid var(--color-contrast-light);
            margin: 5px 0;
        }
        #dropdown-logout-btn { color: var(--color-yellow); }
        #dropdown-logout-btn:hover { color: var(--color-bg); background-color: var(--color-yellow) !important; }
        nav ul li button#logout-btn { background-color: var(--color-yellow); color: var(--color-bg); font-weight: bold; } /* Botón original de logout, puede eliminarse si se prefiere solo el dropdown */
        nav ul li button#logout-btn:hover { background-color: var(--color-text); color: var(--color-bg); }


        /* --- Estilos para las "PÁGINAS" y TRANSICIONES --- */
        .page-content { display: none; opacity: 0; padding: 40px 0; min-height: 70vh; }
        .page-content.active-page { display: block; animation: pageFadeIn var(--animation-duration) ease-out forwards; }
        .page-content.exiting-page { animation: pageFadeOut var(--animation-duration) ease-in forwards; }
        @keyframes pageFadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pageFadeOut { from { opacity: 1; transform: translateY(0); } to { opacity: 0; transform: translateY(-20px); } }

        /* --- Sección Hero --- */
        #hero { background-size: cover; background-position: center center; background-repeat: no-repeat; color: #fff; text-align: center; padding: 80px 20px 100px; min-height: auto; display: flex; flex-direction: column; justify-content: center; align-items: center; position: relative; border-radius: 10px; margin-bottom: 40px; }
        #hero::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0,0,0,0.1); border-radius: 10px;}
        #hero h1 { font-size: clamp(2.5em, 5vw, 4.0em); margin-bottom: 20px; text-shadow: 0 0 15px rgba(29, 145, 247, 0.7), 0 0 20px rgba(29, 145, 247, 0.5); animation: none; opacity:1; transform: none;}
        #hero p { font-size: clamp(1.1em, 2.5vw, 1.3em); margin-bottom: 30px; max-width: 600px; color: var(--color-text-muted); animation: none; opacity:1; transform: none;}
        .hero-button { background: linear-gradient(45deg, var(--color-blue), var(--color-green)); color: var(--color-bg); border: none; padding: 18px 35px; font-size: 1.1em; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; cursor: pointer; border-radius: 50px; transition: all var(--transition-speed) ease; box-shadow: 0 5px 15px rgba(85, 251, 131, 0.3); animation: none; opacity:1; transform: none; }
        .hero-button:hover, .hero-button:focus { transform: translateY(-5px) scale(1.05); box-shadow: 0 8px 25px rgba(29, 145, 247, 0.5); background: linear-gradient(45deg, var(--color-green), var(--color-blue)); }

        /* --- Secciones de Contenido Genéricas (Noticias, etc.) --- */
        .content-section { padding: 40px 0; }
        .news-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; margin-top: 20px; }
        .news-card { background-color: var(--color-contrast); border-radius: 10px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.2); transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease; display: flex; flex-direction: column; }
        .news-card:hover { transform: translateY(-10px); box-shadow: 0 10px 25px rgba(29, 145, 247, 0.3); }
        .news-card-image { height: 200px; background-color: var(--color-contrast-light); display: flex; align-items: center; justify-content: center; color: var(--color-text-muted); font-size: 1.2em; }
        .news-card-image img { width: 100%; height: 100%; object-fit: cover; }
        .news-card-content { padding: 25px; flex-grow: 1; display: flex; flex-direction: column; }
        .news-card-content h3 { color: var(--color-yellow); font-size: 1.4em; }
        .news-card-content p { color: var(--color-text-muted); font-size: 0.95em; margin-bottom: 15px; flex-grow: 1; }
        .news-card-content small { display: block; color: var(--color-blue); margin-bottom: 20px; font-style: italic; }
        .read-more-btn { display: inline-block; background-color: var(--color-blue); color: var(--color-contrast); padding: 10px 20px; border-radius: 5px; font-weight: bold; text-align: center; transition: background-color var(--transition-speed) ease; align-self: flex-start; cursor:pointer; }
        .read-more-btn:hover { background-color: var(--color-green); color: var(--color-bg); }
        
        /* --- Estilos de Modales (General) --- */
        .modal { display: none; position: fixed; z-index: 1001; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(18, 20, 22, 0.85); backdrop-filter: blur(5px); padding-top: 2%; opacity: 0; transition: opacity var(--transition-speed) ease-in-out; }
        .modal.active { display: block; opacity: 1; }
        .modal-content { background-color: var(--color-contrast); margin: 0 auto; padding: 35px 40px; border: 1px solid var(--color-contrast-light); width: 90%; max-width: 480px; border-radius: 12px; position: relative; box-shadow: 0 10px 30px rgba(0,0,0,0.5); transform: scale(0.95); transition: transform var(--transition-speed) ease-in-out; }
        .modal.active .modal-content { transform: scale(1); }
        .close-btn { color: var(--color-text-muted); position: absolute; top: 15px; right: 20px; font-size: 32px; font-weight: bold; line-height: 1; transition: color var(--transition-speed) ease, transform 0.2s ease; cursor:pointer; }
        .close-btn:hover, .close-btn:focus { color: var(--color-yellow); text-decoration: none; transform: rotate(90deg); }
        .modal-content h3 { text-align: center; margin-bottom: 30px; color: var(--color-blue); font-size: 1.8em; font-weight: 700; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 500; color: var(--color-text-muted); }
        .modal-content input[type="email"], .modal-content input[type="password"], .modal-content input[type="text"] { width: 100%; padding: 14px 18px; border: 2px solid var(--color-contrast-light); background-color: var(--color-bg); color: var(--color-text); border-radius: 8px; font-size: 1em; transition: border-color var(--transition-speed) ease, box-shadow var(--transition-speed) ease; }
        .modal-content input:focus { outline: none; border-color: var(--color-blue); box-shadow: 0 0 0 3px rgba(29, 145, 247, 0.3); }
        .modal-content button[type="submit"] { background: linear-gradient(45deg, var(--color-blue), var(--color-green)); color: var(--color-bg); font-weight: bold; padding: 15px 20px; border: none; border-radius: 8px; cursor: pointer; width: 100%; font-size: 1.1em; text-transform: uppercase; letter-spacing: 0.5px; transition: all var(--transition-speed) ease; box-shadow: 0 3px 10px rgba(85, 251, 131, 0.2); }
        .modal-content button[type="submit"]:hover, .modal-content button[type="submit"]:focus { transform: translateY(-3px); box-shadow: 0 6px 15px rgba(29, 145, 247, 0.4); background: linear-gradient(45deg, var(--color-green), var(--color-blue)); }
        .modal-content .form-footer { text-align: center; margin-top: 25px; font-size: 0.9em; color: var(--color-text-muted); }
        .modal-content .form-footer a { color: var(--color-yellow); font-weight: bold; }
        .modal-content .form-footer a:hover { color: var(--color-green); }

        /* --- MODAL DETALLES DE NOTICIA --- */
        #news-detail-modal .modal-content { max-width: 800px; }
        .news-detail-image-container { width: 100%; height: 300px; margin-bottom: 20px; border-radius: 8px; overflow: hidden; background-color: var(--color-contrast-light); border: 2px solid var(--color-blue); box-shadow: 0 0 15px var(--color-blue); }
        .news-detail-image-container img { width: 100%; height: 100%; object-fit: cover; }
        .news-detail-text { margin-bottom: 25px; line-height: 1.8; color: var(--color-text-muted); }
        .news-detail-actions { margin-bottom: 25px; display: flex; gap: 15px; }
        .news-detail-actions button { background-color: var(--color-yellow); color: var(--color-bg); }
        .news-detail-comments-section h4 { color: var(--color-green); margin-bottom: 15px; border-top: 1px solid var(--color-contrast-light); padding-top: 20px; }
        .news-detail-comment { background-color: var(--color-bg); padding: 10px 15px; border-radius: 5px; margin-bottom: 10px; border-left: 3px solid var(--color-blue); }
        .news-detail-comment strong { color: var(--color-yellow); }
        .news-detail-comment small { color: var(--color-text-muted); font-size: 0.8em; display: block; }
        .news-detail-comment-form textarea { width: 100%; padding: 10px; background-color: var(--color-bg); border: 1px solid var(--color-contrast-light); color: var(--color-text); border-radius: 5px; min-height: 80px; margin-bottom: 10px; }
        .news-detail-comment-form button { display: block; margin-left: auto; }
        .disabled-feature-notice { color: var(--color-yellow); font-style: italic; text-align: center; padding: 10px; background-color: rgba(252, 207, 58, 0.1); border-radius: 5px; }

        /* --- NORMAS, ABOUT --- */
        #about p, .rules-section p, .forum-section p, #page-profile p, #page-settings p { font-size: 1.1em; color: var(--color-text-muted); max-width: 800px; margin: 0 auto 20px; text-align: left; }
        .rules-list { list-style: none; padding-left: 0; }
        .rules-list li { background-color: var(--color-contrast); padding: 15px 20px; margin-bottom: 10px; border-radius: 8px; border-left: 5px solid var(--color-blue); box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .rules-list li strong { color: var(--color-green); }
        
        /* --- FORO --- */
        .forum-view { display: none; }
        .forum-view.active-forum-view { display: block; animation: pageFadeIn 0.3s ease-out forwards; }
        .forum-categories-list, .forum-threads-list { list-style: none; padding-left: 0; }
        .forum-categories-list li, .forum-threads-list li { background-color: var(--color-contrast); padding: 20px; margin-bottom: 15px; border-radius: 8px; border-left: 5px solid var(--color-blue); box-shadow: 0 3px 8px rgba(0,0,0,0.15); transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .forum-categories-list li:hover, .forum-threads-list li:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(29, 145, 247, 0.2); }
        .forum-categories-list li a, .forum-threads-list li a { color: var(--color-yellow); font-size: 1.2em; text-decoration: none; }
        .forum-categories-list li p, .forum-threads-list li p { font-size: 0.9em; margin-bottom: 0; color: var(--color-text-muted); }
        .forum-threads-list li .thread-meta { font-size: 0.8em; color: var(--color-blue); margin-top: 5px; }
        .forum-back-button { margin-bottom: 25px; background-color: var(--color-contrast-light); }
        #forum-thread-view-content h3 { color: var(--color-green); margin-bottom: 20px; text-align: left;}
        .thread-messages-container { max-height: 500px; overflow-y: auto; padding: 15px; background-color: var(--color-bg); border: 1px solid var(--color-contrast-light); border-radius: 8px; margin-bottom: 20px; }
        .thread-message { padding: 10px 15px; border-radius: 8px; margin-bottom: 10px; border: 1px solid transparent; }
        .thread-message.user-message { background-color: rgba(29, 145, 247, 0.15); border-left: 3px solid var(--color-blue); margin-left: 30px; }
        .thread-message.other-message { background-color: rgba(85, 251, 131, 0.1); border-left: 3px solid var(--color-green); margin-right: 30px; }
        .thread-message .message-author { font-weight: bold; color: var(--color-yellow); margin-bottom: 3px; }
        .thread-message .message-timestamp { font-size: 0.75em; color: var(--color-text-muted); display: block; text-align: right; }
        .thread-message-form textarea { width: 100%; padding: 12px; background-color: var(--color-contrast-light); border: 1px solid var(--color-contrast-light); color: var(--color-text); border-radius: 5px; min-height: 70px; margin-bottom: 10px; resize: vertical; }
        .thread-message-form button { display: block; margin-left: auto; background-color: var(--color-green); color: var(--color-bg); }
        .neon-effect-blue { box-shadow: 0 0 5px var(--color-blue), 0 0 10px var(--color-blue), 0 0 15px var(--color-blue); }
        .neon-text-green { text-shadow: 0 0 5px var(--color-green), 0 0 10px var(--color-green); }

        /* --- Footer --- */
        footer { background-color: var(--color-contrast); color: var(--color-text-muted); text-align: center; padding: 50px 20px; border-top: 3px solid var(--color-blue); margin-top: 60px; }
        footer p { margin-bottom: 15px; font-size: 0.95em; }
        footer .social-links a { margin: 0 12px; color: var(--color-text-muted); font-size: 1.8em; transition: color var(--transition-speed) ease, transform 0.2s ease; display: inline-block; }
        footer .social-links a:hover { color: var(--color-blue); transform: scale(1.2) rotate(5deg); }
        .hidden { display: none !important; }

        /* --- Responsividad --- */
        @media (max-width: 768px) {
            body { font-size: 15px; }
            nav { flex-direction: column; align-items: center; }
            nav .logo { margin-bottom: 15px; }
            nav ul { margin-top: 10px; width: 100%; flex-direction: column; align-items: center; }
            nav ul li { margin-left: 0; margin-bottom: 10px; width: 100%; /* Para que el user menu no se vea mal */ }
            #user-info-nav { width: auto; margin: 0 auto; /* Centrar el botón de usuario si es el único visible */ }
            .user-dropdown-menu { left: 50%; transform: translateX(-50%); min-width: 220px; /* Ajustar dropdown en móvil */ }
            nav ul li a, nav ul li button.nav-button { display: block; text-align: center; width: 80%; margin: 0 auto; }
            #hero { padding: 60px 15px 80px; }
            .news-grid { grid-template-columns: 1fr; }
            .modal-content { width: 95%; padding: 25px; }
            #news-detail-modal .modal-content { padding: 20px; }
            .thread-message.user-message { margin-left: 10px; }
            .thread-message.other-message { margin-right: 10px; }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <div class="logo">Samp<span>Proyect</span></div>
                <ul>
                    <li><a href="#page-inicio" class="nav-page-link active-link">Inicio</a></li>
                    <li><a href="#page-foro" class="nav-page-link">Foro</a></li>
                    <li><a href="#page-normas" class="nav-page-link">Normas</a></li>
                    <li id="login-li"><button type="button" id="login-btn" class="nav-button">Login</button></li>
                    <li id="register-li"><button type="button" id="register-btn" class="nav-button">Registro</button></li>
                    
                    <li id="user-info-nav" class="hidden">
                        <div id="user-menu-button" class="user-menu-button" aria-haspopup="true" aria-expanded="false">
                            <span id="user-icon-display">👤</span>
                            <span id="user-info"></span>
                            <span id="dropdown-arrow">▼</span>
                        </div>
                        <div id="user-dropdown-menu" class="user-dropdown-menu" role="menu">
                            <ul>
                                <li role="none"><a href="#page-profile" role="menuitem" class="dropdown-page-link">Ver Perfil</a></li>
                                <li role="none"><a href="#page-settings" role="menuitem" class="dropdown-page-link">Configurar Cuenta</a></li>
                                <li role="none"><hr></li>
                                <li role="none"><button type="button" id="dropdown-logout-btn" role="menuitem">Cerrar Sesión</button></li>
                            </ul>
                        </div>
                    </li>
                    </ul>
            </nav>
        </div>
    </header>

    <main>
        <div id="page-inicio" class="page-content active-page">
            <section id="hero">
                 <h1>Tu Destino Roleplay Definitivo</h1>
                <p>Sumérgete en un mundo de posibilidades infinitas, forja tu historia y conviértete en leyenda. ¡La aventura te espera!</p>
                <button class="hero-button">Únete a la Aventura</button>
            </section>
            <div class="container">
                <section id="news" class="content-section">
                    <h2 id="news-title">Últimas Novedades</h2>
                    <div class="news-grid"></div>
                </section>
                <section id="about" class="content-section">
                    <h2>¿Quiénes Somos?</h2>
                    <p>En <strong>SampProyect</strong>, nos dedicamos a crear la experiencia de Roleplay más inmersiva y dinámica...</p>
                </section>
            </div>
        </div>

        <div id="page-foro" class="page-content">
            <div class="container">
                <div id="forum-categories-view" class="forum-view active-forum-view">
                    <section class="forum-section content-section">
                        <h2>Foros de la Comunidad</h2>
                        <p>¡Bienvenido a nuestros foros! Aquí puedes discutir sobre el servidor, compartir ideas, reportar problemas o simplemente charlar con otros jugadores.</p>
                        <ul id="forum-categories-list-container" class="forum-categories-list"></ul>
                    </section>
                </div>
                <div id="forum-threads-view" class="forum-view">
                    <button id="forum-back-to-categories" class="forum-back-button button-style">« Volver a Categorías</button>
                    <h2 id="forum-category-title"></h2>
                    <ul id="forum-threads-list-container" class="forum-threads-list"></ul>
                    <div class="disabled-feature-notice">La creación de nuevos hilos aún no está implementada.</div>
                </div>
                <div id="forum-thread-view" class="forum-view">
                    <button id="forum-back-to-threads" class="forum-back-button button-style">« Volver a Hilos</button>
                    <div id="forum-thread-view-content">
                        <h3 id="forum-thread-title"></h3>
                        <div class="thread-messages-container" id="thread-messages-container"></div>
                        <form id="thread-message-form" class="thread-message-form">
                            <textarea id="thread-new-message-text" placeholder="Escribe tu mensaje aquí..."></textarea>
                            <button type="submit">Enviar Mensaje</button>
                            <div class="disabled-feature-notice" id="forum-send-message-notice" style="margin-top:10px;">La función de enviar mensajes aún no está terminada.</div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <div id="page-normas" class="page-content">
             <div class="container">
                <section class="rules-section content-section">
                    <h2>Normativas del Servidor</h2>
                    <p>Para garantizar una experiencia de juego justa, divertida y respetuosa para todos los miembros de nuestra comunidad, es crucial que conozcas y sigas nuestras normativas...</p>
                    <h3>Reglas Generales</h3> <ul class="rules-list"> <li><strong>Respeto:</strong> Trata a todos los jugadores y miembros del staff con respeto...</li><li><strong>Cheats/Hacks:</strong> El uso de cualquier tipo de programa externo...</li><li><strong>Multicuentas:</strong> No se permiten multicuentas...</li><li><strong>Publicidad:</strong> Prohibida la publicidad...</li> </ul>
                    <h3>Reglas de Roleplay (Ejemplos)</h3> <ul class="rules-list"> <li><strong>PG (Powergaming):</strong> Realizar acciones que serían imposibles...</li><li><strong>MG (Metagaming):</strong> Utilizar información OOC...</li><li><strong>DM (Deathmatch):</strong> Matar sin motivo de rol...</li><li><strong>CK (Character Kill):</strong> Asesinato permanente...</li><li><strong>NVVPJ (No Valorar la Vida del Personaje):</strong> No actuar de forma realista...</li> </ul>
                    <p style="margin-top: 20px;">Estas son solo algunas de las normativas principales...</p>
                </section>
            </div>
        </div>

        <div id="page-profile" class="page-content">
            <div class="container">
                <section class="content-section">
                    <h2>Perfil de Usuario</h2>
                    <p class="disabled-feature-notice">Esta sección estará disponible próximamente. Aquí podrás ver y editar los detalles de tu perfil.</p>
                    <button onclick="switchPage('page-inicio')" class="button-style" style="margin-top:20px;">Volver a Inicio</button>
                </section>
            </div>
        </div>

        <div id="page-settings" class="page-content">
            <div class="container">
                <section class="content-section">
                    <h2>Configuración de Cuenta</h2>
                    <p class="disabled-feature-notice">Esta sección estará disponible próximamente. Aquí podrás ajustar las configuraciones de tu cuenta.</p>
                    <button onclick="switchPage('page-inicio')" class="button-style" style="margin-top:20px;">Volver a Inicio</button>
                </section>
            </div>
        </div>
    </main>

    <div id="news-detail-modal" class="modal">
        <div class="modal-content"> <span class="close-btn" data-modal-id="news-detail-modal">×</span> <h3 id="news-detail-title">Detalle de la Noticia</h3> <div class="news-detail-image-container"> <img id="news-detail-large-image" src="" alt="Imagen de la noticia en detalle"> </div> <div id="news-detail-text" class="news-detail-text"></div> <div id="news-detail-actions" class="news-detail-actions"></div> <div class="news-detail-comments-section"> <h4>Comentarios</h4> <div id="news-detail-comments-list"></div> <form id="news-detail-comment-form" class="news-detail-comment-form"> <textarea id="news-detail-new-comment" placeholder="Escribe tu comentario... (Función no implementada)"></textarea> <button type="submit">Comentar</button> <div class="disabled-feature-notice" style="margin-top:10px;">La función de enviar comentarios aún no está terminada.</div> </form> </div> </div>
    </div>

    <div id="login-modal" class="modal">
        <div class="modal-content"> <span class="close-btn" data-modal-id="login-modal">×</span> <h3>Iniciar Sesión</h3> <form id="login-form"> <div class="form-group"><label for="login-email">Correo</label><input type="email" id="login-email" placeholder="tu@correo.com" required></div> <div class="form-group"><label for="login-password">Contraseña</label><input type="password" id="login-password" placeholder="••••••••" required></div> <button type="submit">Entrar Ahora</button> </form> <div class="form-footer">¿No tienes cuenta? <a href="#" id="show-register-from-login">Regístrate</a></div> </div>
    </div>
    <div id="register-modal" class="modal">
        <div class="modal-content"> <span class="close-btn" data-modal-id="register-modal">×</span> <h3>Crear Cuenta</h3> <form id="register-form"> <div class="form-group"><label for="register-username">Usuario (PJ)</label><input type="text" id="register-username" placeholder="TuNombreEnElJuego" required></div> <div class="form-group"><label for="register-email">Correo</label><input type="email" id="register-email" placeholder="tu@correo.com" required></div> <div class="form-group"><label for="register-password">Contraseña</label><input type="password" id="register-password" placeholder="Mínimo 6 caracteres" required></div> <button type="submit">Crear Cuenta</button> </form> <div class="form-footer">¿Ya tienes cuenta? <a href="#" id="show-login-from-register">Inicia Sesión</a></div> </div>
    </div>

    <footer>
        <div class="container"> <p>© 2025 SampProyect. Diseñado con <span style="color: var(--color-green);">❤</span> por la Comunidad.</p> <div class="social-links"></div> </div>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>

    <script>
        // --- CONFIGURACIÓN DE CONTENIDO DINÁMICO ---
        const siteConfig = {
            heroBackgroundImage: 'utils/hero_background.jpg', 
            newsItems: [ /* ... (igual que antes) ... */ ],
            forumCategories: [ /* ... (igual que antes) ... */ ],
            sampleThreadMessages: { /* ... (igual que antes) ... */ },
            socialLinks: { discord: "https://discord.gg/https://discord.gg/su8TUSfwHQ", forum: "#page-foro", youtube: "https://youtube.com/vespucci-rp", twitter: "https://twitter.com/TU_PERFIL" }
        };
         // (Copia aquí el contenido de siteConfig.newsItems, forumCategories, y sampleThreadMessages de la respuesta anterior si es necesario, para brevedad lo omito aquí)
        siteConfig.newsItems = [
            { id: "news-1", title: "Sistema de Desconocidos", date: "PRÓXIMAMENTE", summary: "Conoce gente...", image: "des/crew.jpeg", largeImage: "des/crew.jpeg", fullText: "Texto completo...", detailButtons: [{ label: "Discutir en Foro", action: "navigateToForumCategory('sugerencias')" }], exampleComments: [] },
            { id: "news-2", title: "Sistema de Logros", date: "PRÓXIMAMENTE", summary: "Gana descubriendo...", image: "des/logros.png", largeImage: "des/logros.png", fullText: "Texto completo...", detailButtons: [], exampleComments: [] },
            { id: "news-3", title: "Nuevas Normativas", date: "22 MAY, 2025", summary: "Actualizamos normativas...", image: "des/sony.png", largeImage: "des/reglasnormativas.png", fullText: "Texto completo...", detailButtons: [ { label: "Ir a Normas", action: "switchToPageById('page-normas')" } ], exampleComments: [] }
        ];
        siteConfig.forumCategories = [
            { id: "anuncios-oficiales", name: "Anuncios Oficiales", description: "Novedades importantes.", threads: [{ id: "thread-an-1", title: "Mantenimiento 25 Mayo", author: "Admin", replies: 2, lastPost: "Hace 5 min" }]},
            { id: "discusion-general", name: "Discusión General", description: "Temas del servidor.", threads: [{ id: "thread-dg-1", title: "¿Trabajo favorito?", author: "Curioso", replies: 32, lastPost: "Ahora" }]},
        ];
        siteConfig.sampleThreadMessages = {
            "thread-an-1": [{ author: "Admin", text: "Mantenimiento de 03:00 a 04:00 AM.", timestamp: "Hace 1 hora", type: "other"}],
            "thread-dg-1": [{ author: "Curioso", text: "¿Cuál es su trabajo favorito?", timestamp: "Hace 1 día", type: "other"}],
        };


        // --- INICIO DEL SCRIPT DE APP.JS ---
        const firebaseConfig = {
            apiKey: "AIzaSyCAj3iwCBSGGS3Xi7kwvW8-MfBZjHi3r1g",
            authDomain: "vespucci-web.firebaseapp.com",
            projectId: "vespucci-web",
            storageBucket: "vespucci-web.firebasestorage.app",
            messagingSenderId: "599783398367",
            appId: "1:599783398367:web:b8fc1b6f3cc0c3afdf826a",
            measurementId: "G-RP5VPPLGEH"
        };
        try { if (!firebase.apps.length) { firebase.initializeApp(firebaseConfig); } } catch (e) { console.error("Error Firebase (revisa credenciales):", e); }
        const auth = firebase.auth();
        const db = firebase.firestore();

        const loginLi = document.getElementById('login-li');
        const registerLi = document.getElementById('register-li');
        const userInfoNav = document.getElementById('user-info-nav');
        const userInfoDisplay = document.getElementById('user-info');
        const userMenuButton = document.getElementById('user-menu-button');
        const userDropdownMenu = document.getElementById('user-dropdown-menu');
        const dropdownLogoutBtn = document.getElementById('dropdown-logout-btn');

        const loginModalEl = document.getElementById('login-modal');
        const registerModalEl = document.getElementById('register-modal');
        const newsDetailModalEl = document.getElementById('news-detail-modal');
        const closeButtons = document.querySelectorAll('.close-btn');
        const loginForm = document.getElementById('login-form');
        const registerForm = document.getElementById('register-form');
        const showRegisterFromLogin = document.getElementById('show-register-from-login');
        const showLoginFromRegister = document.getElementById('show-login-from-register');
        const newsDetailCommentForm = document.getElementById('news-detail-comment-form');
        const threadMessageForm = document.getElementById('thread-message-form');

        const navPageLinks = document.querySelectorAll('.nav-page-link');
        const pageContents = document.querySelectorAll('.page-content');
        let currentActivePageId = 'page-inicio'; 

        function switchPage(targetPageId, skipScroll = false) {
            const newPage = document.getElementById(targetPageId);
            const currentPage = document.getElementById(currentActivePageId);
            if (!newPage || (newPage === currentPage && (skipScroll || window.scrollY === 0))) return;
            if (newPage === currentPage && !skipScroll) { window.scrollTo({ top: 0, behavior: 'smooth' }); return; }

            // Quitar 'active-link' de los links de navegación principales
            navPageLinks.forEach(link => link.classList.remove('active-link'));
            // Añadir 'active-link' solo si es un link de navegación principal
            const mainNavLink = Array.from(navPageLinks).find(link => link.getAttribute('href') === `#${targetPageId}`);
            if (mainNavLink) mainNavLink.classList.add('active-link');
            
            closeUserDropdown(); // Cerrar dropdown si está abierto al cambiar de página

            const showNewPageAfterExit = () => {
                newPage.style.display = 'block'; 
                requestAnimationFrame(() => newPage.classList.add('active-page'));
                currentActivePageId = targetPageId;
                if (!skipScroll) window.scrollTo({ top: 0, behavior: 'smooth' });
                if (targetPageId === 'page-foro') showForumView('forum-categories-view');
            };

            if (currentPage && currentPage !== newPage) {
                currentPage.classList.remove('active-page'); 
                currentPage.classList.add('exiting-page');   
                currentPage.addEventListener('animationend', function onExit() {
                    currentPage.style.display = 'none'; 
                    currentPage.classList.remove('exiting-page');
                    currentPage.removeEventListener('animationend', onExit);
                    showNewPageAfterExit();
                }, { once: true });
            } else {
                showNewPageAfterExit();
            }
        }
        function switchToPageById(pageId) { switchPage(pageId); }

        navPageLinks.forEach(link => {
            link.addEventListener('click', (e) => { e.preventDefault(); switchPage(link.getAttribute('href').substring(1)); });
        });
        
        function openModal(modal) { if (modal) modal.classList.add('active'); }
        function closeModal(modal) { if (modal) modal.classList.remove('active'); }
        if (document.getElementById('login-btn')) document.getElementById('login-btn').addEventListener('click', (e) => { e.preventDefault(); openModal(loginModalEl); });
        if (document.getElementById('register-btn')) document.getElementById('register-btn').addEventListener('click', (e) => { e.preventDefault(); openModal(registerModalEl); });
        closeButtons.forEach(btn => { btn.addEventListener('click', () => { closeModal(document.getElementById(btn.getAttribute('data-modal-id'))); }); });
        window.addEventListener('click', (event) => { if (event.target.classList.contains('modal')) closeModal(event.target); });
        window.addEventListener('keydown', (event) => { if (event.key === 'Escape') { document.querySelectorAll('.modal.active').forEach(closeModal); }});
        if (showRegisterFromLogin) { showRegisterFromLogin.addEventListener('click', (e) => { e.preventDefault(); closeModal(loginModalEl); openModal(registerModalEl); }); }
        if (showLoginFromRegister) { showLoginFromRegister.addEventListener('click', (e) => { e.preventDefault(); closeModal(registerModalEl); openModal(loginModalEl); }); }

        // --- USER DROPDOWN MENU ---
        function toggleUserDropdown() {
            userDropdownMenu.classList.toggle('active');
            userMenuButton.classList.toggle('open');
            userMenuButton.setAttribute('aria-expanded', userDropdownMenu.classList.contains('active'));
        }
        function closeUserDropdown() {
            userDropdownMenu.classList.remove('active');
            userMenuButton.classList.remove('open');
            userMenuButton.setAttribute('aria-expanded', 'false');
        }
        if (userMenuButton) {
            userMenuButton.addEventListener('click', (e) => {
                e.stopPropagation(); // Evitar que el clic en el botón cierre inmediatamente el menú (por el listener global)
                toggleUserDropdown();
            });
        }
        // Cerrar dropdown si se hace clic fuera
        window.addEventListener('click', (e) => {
            if (userDropdownMenu.classList.contains('active') && !userMenuButton.contains(e.target) && !userDropdownMenu.contains(e.target)) {
                closeUserDropdown();
            }
        });
        // Cerrar dropdown con tecla Escape
        window.addEventListener('keydown', (event) => {
            if (event.key === 'Escape' && userDropdownMenu.classList.contains('active')) {
                closeUserDropdown();
            }
        });
        // Manejar clics en los items del dropdown que son links de página
        document.querySelectorAll('.dropdown-page-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetPageId = link.getAttribute('href').substring(1);
                switchPage(targetPageId);
                closeUserDropdown(); 
            });
        });
        if(dropdownLogoutBtn) {
            dropdownLogoutBtn.addEventListener('click', () => {
                if (!firebase.apps.length || !auth) { alert("Error: Firebase no configurado."); return; }
                auth.signOut().catch(err => alert("Error logout: " + err.message));
                closeUserDropdown(); 
            });
        }


        // --- DETALLES DE NOTICIA (Modal) ---
        // (Sin cambios respecto a la anterior, se asume que está bien)
        function showNewsDetail(newsId) { /* ... (código de la respuesta anterior) ... */ }
        if (newsDetailCommentForm) { newsDetailCommentForm.addEventListener('submit', (e) => {e.preventDefault(); alert('Comentarios no implementados aún.');});}
        function showNewsDetail(newsId) {
            const newsItem = siteConfig.newsItems.find(item => item.id === newsId);
            if (!newsItem) return;
            document.getElementById('news-detail-title').textContent = newsItem.title;
            document.getElementById('news-detail-large-image').src = newsItem.largeImage || newsItem.image;
            document.getElementById('news-detail-text').innerHTML = (newsItem.fullText || "").replace(/\n/g, '<br>');
            const actionsContainer = document.getElementById('news-detail-actions');
            actionsContainer.innerHTML = '';
            if (newsItem.detailButtons) newsItem.detailButtons.forEach(btnData => { /* ... */ });
            const commentsList = document.getElementById('news-detail-comments-list');
            commentsList.innerHTML = '';
            if (newsItem.exampleComments && newsItem.exampleComments.length) newsItem.exampleComments.forEach(comment => { /* ... */ }); else commentsList.innerHTML = '<p>No hay comentarios.</p>';
            openModal(newsDetailModalEl);
        }

        // --- FUNCIONALIDAD DEL FORO (Simulada) ---
        // (Sin cambios principales respecto a la anterior, se asume que está bien)
        const forumCategoriesView = document.getElementById('forum-categories-view');
        const forumThreadsView = document.getElementById('forum-threads-view');
        const forumThreadView = document.getElementById('forum-thread-view');
        function showForumView(viewId) { /* ... */ }
        function populateForumCategories() { /* ... */ }
        function navigateToForumCategory(categoryId) { /* ... */ }
        function showForumCategory(categoryId) { /* ... */ }
        function showForumThread(threadId) { /* ... */ }
        if(document.getElementById('forum-back-to-categories')) document.getElementById('forum-back-to-categories').addEventListener('click', () => showForumView('forum-categories-view'));
        if(document.getElementById('forum-back-to-threads')) document.getElementById('forum-back-to-threads').addEventListener('click', () => { /* ... */ });
        if(threadMessageForm) { threadMessageForm.addEventListener('submit', (e) => {e.preventDefault(); document.getElementById('forum-send-message-notice').textContent = "Envío no implementado.";}); }


        // --- DOMContentLoaded ---
        document.addEventListener('DOMContentLoaded', () => {
            const heroSection = document.getElementById('hero');
            if (heroSection && siteConfig.heroBackgroundImage) heroSection.style.backgroundImage = `linear-gradient(rgba(18,20,22,0.85), rgba(18,20,22,0.95)), url('${siteConfig.heroBackgroundImage}')`;
            const newsGrid = document.querySelector('#page-inicio #news .news-grid');
            if (newsGrid && siteConfig.newsItems && siteConfig.newsItems.length > 0) { /* ... (código de la respuesta anterior para news) ... */ }
            else if (newsGrid) { document.getElementById('news-title').textContent="Próximamente"; newsGrid.innerHTML = '<p>No hay noticias.</p>';}
            const socialLinksContainer = document.querySelector('footer .social-links');
            if (socialLinksContainer && siteConfig.socialLinks) { /* ... (código de la respuesta anterior para social links) ... */ }

            pageContents.forEach(page => { /* ... (código de la respuesta anterior para page setup) ... */ });
            if (window.location.hash) { /* ... (código de la respuesta anterior para hash navigation) ... */ }
            populateForumCategories(); // Asegúrate que esta función esté definida
        });
         // Rellenar noticias
        const newsGrid = document.querySelector('#page-inicio #news .news-grid');
        if (newsGrid && siteConfig.newsItems && siteConfig.newsItems.length > 0) {
            newsGrid.innerHTML = ''; 
            siteConfig.newsItems.forEach(item => {
                const newsCardHTML = `<article class="news-card" data-news-id="${item.id}"><div class="news-card-image"><img src="${item.image}" alt="${item.title}"></div><div class="news-card-content"><h3>${item.title}</h3><small>Fecha: ${item.date}</small><p>${item.summary}</p><button type="button" class="read-more-btn">Leer Más »</button></div></article>`;
                newsGrid.insertAdjacentHTML('beforeend', newsCardHTML);
            });
            newsGrid.querySelectorAll('.read-more-btn').forEach(btn => btn.addEventListener('click', (e) => showNewsDetail(e.target.closest('.news-card').dataset.newsId)));
        }
        // Rellenar links sociales
        const socialLinksContainer = document.querySelector('footer .social-links');
        if (socialLinksContainer && siteConfig.socialLinks) {
            socialLinksContainer.innerHTML = `<a href="${siteConfig.socialLinks.discord}" title="Discord" target="_blank">👾</a> <a href="${siteConfig.socialLinks.forum}" title="Foro" id="footer-forum-link">📚</a> <a href="${siteConfig.socialLinks.youtube}" title="YouTube" target="_blank">▶️</a> <a href="${siteConfig.socialLinks.twitter}" title="Twitter/X" target="_blank">🐦</a>`;
            document.getElementById('footer-forum-link').addEventListener('click', (e) => {e.preventDefault(); switchPage('page-foro');});
        }
         // Cargar contenido del foro
        function populateForumCategories() {
            const container = document.getElementById('forum-categories-list-container');
            if (!container || !siteConfig.forumCategories) return;
            container.innerHTML = '';
            siteConfig.forumCategories.forEach(cat => {
                const listItem = document.createElement('li');
                listItem.innerHTML = `<h4><a href="#" data-category-id="${cat.id}">${cat.name}</a></h4><p>${cat.description}</p>`;
                listItem.querySelector('a').addEventListener('click', (e) => { e.preventDefault(); navigateToForumCategory(cat.id); });
                container.appendChild(listItem);
            });
        }
        // (Re-define las funciones del foro showForumView, navigateToForumCategory, showForumCategory, showForumThread de la respuesta anterior aquí para que estén disponibles)
        let currentForumCategory = null;
        function showForumView(viewId) { [forumCategoriesView, forumThreadsView, forumThreadView].forEach(v => v.classList.remove('active-forum-view')); document.getElementById(viewId)?.classList.add('active-forum-view');}
        function navigateToForumCategory(categoryId) { if(currentActivePageId !== 'page-foro') switchPage('page-foro', true); setTimeout(()=>showForumCategory(categoryId), currentActivePageId !== 'page-foro' ? 500:0);}
        function showForumCategory(categoryId) { currentForumCategory = siteConfig.forumCategories.find(c=>c.id===categoryId); if(!currentForumCategory)return; document.getElementById('forum-category-title').textContent=currentForumCategory.name; const listEl = document.getElementById('forum-threads-list-container'); listEl.innerHTML=''; if(currentForumCategory.threads?.length){currentForumCategory.threads.forEach(t=>{const li=document.createElement('li');li.innerHTML=`<h4><a href="#" data-thread-id="${t.id}">${t.title}</a></h4><p class="thread-meta">Por: ${t.author} | Respuestas: ${t.replies} | Último: ${t.lastPost}</p>`;li.querySelector('a').addEventListener('click',e=>{e.preventDefault();showForumThread(t.id)});listEl.appendChild(li)})}else{listEl.innerHTML='<li><p>No hay hilos.</p></li>'} showForumView('forum-threads-view');}
        function showForumThread(threadId) { const threadData = currentForumCategory?.threads.find(t=>t.id===threadId);const messages=siteConfig.sampleThreadMessages[threadId]||[];document.getElementById('forum-thread-title').textContent=threadData?.title||"Hilo";const msgContainer=document.getElementById('thread-messages-container');msgContainer.innerHTML='';if(messages.length){messages.forEach(m=>{const div=document.createElement('div');div.className=`thread-message ${m.type==='user'?'user-message':'other-message'}`;div.innerHTML=`<div class="message-author">${m.author}</div><div class="message-text">${m.text}</div><div class="message-timestamp">${m.timestamp}</div>`;msgContainer.appendChild(div)})}else{msgContainer.innerHTML='<p>No hay mensajes.</p>'}msgContainer.scrollTop=msgContainer.scrollHeight;showForumView('forum-thread-view');}


        // --- Lógica de Autenticación ---
        if (registerForm) {
            registerForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const email = registerForm['register-email'].value, pass = registerForm['register-password'].value, userPJ = registerForm['register-username'].value;
                if (!email || !pass || !userPJ) { alert("Completa todos los campos."); return; }
                if (pass.length < 6) { alert("Contraseña: mín. 6 caracteres."); return; }
                if (!firebase.apps.length || !auth) { alert("Error: Firebase no configurado."); return; }
                auth.createUserWithEmailAndPassword(email, pass)
                    .then(cred => db.collection('users').doc(cred.user.uid).set({ email: cred.user.email, samp_username: userPJ, createdAt: firebase.firestore.FieldValue.serverTimestamp() }))
                    .then(() => { alert("¡Registro exitoso!"); registerForm.reset(); closeModal(registerModalEl); /* onAuthStateChanged se encargará de la UI */ })
                    .catch(err => alert("Error registro: " + err.message));
            });
        }
        if (loginForm) {
            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const email = loginForm['login-email'].value, pass = loginForm['login-password'].value;
                if (!email || !pass) { alert("Ingresa correo y contraseña."); return; }
                if (!firebase.apps.length || !auth) { alert("Error: Firebase no configurado."); return; }
                auth.signInWithEmailAndPassword(email, pass)
                    .then(() => { loginForm.reset(); closeModal(loginModalEl); /* onAuthStateChanged se encargará de la UI */ })
                    .catch(err => alert("Error login: " + err.message));
            });
        }
        
        if (firebase.apps.length && auth) {
            auth.onAuthStateChanged(async user => {
                if (user) {
                    loginLi.classList.add('hidden');
                    registerLi.classList.add('hidden');
                    userInfoNav.classList.remove('hidden');
                    // document.getElementById('logout-li')?.classList.remove('hidden'); // Si aún usas el botón de logout principal
                    try { 
                        const doc = await db.collection('users').doc(user.uid).get(); 
                        const pjName = doc.exists ? (doc.data().samp_username || user.email.split('@')[0]) : user.email.split('@')[0];
                        userInfoDisplay.textContent = pjName;
                    } 
                    catch (err) { console.error("Error Firestore:", err); userInfoDisplay.textContent = user.email.split('@')[0]; }
                } else { 
                    loginLi.classList.remove('hidden');
                    registerLi.classList.remove('hidden');
                    userInfoNav.classList.add('hidden');
                    // document.getElementById('logout-li')?.classList.add('hidden');
                    userInfoDisplay.textContent = '';
                    closeUserDropdown(); // Asegurarse que el dropdown esté cerrado al hacer logout
                }
            });
        } else { console.warn("Firebase no inicializado. Autenticación no funcionará."); }
    </script>
</body>
</html>